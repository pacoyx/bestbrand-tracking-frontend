import{a as Ae,b as ke,c as lt,d as mt}from"./chunk-ZNJW7USK.js";import{a as ge,b as he,c as Ce,d as be,e as _e,f as Se,g as Ee,h as xe,i as ve,j as Me,k as Ie,l as Fe,m as Re,n as Ue,o as V,p as ye,q as H,r as Pe,s as De,t as Te,u as we,v as Ne,w as Oe,x as Ge,y as je}from"./chunk-EWYNIEHO.js";import{A as pe,B as de,Ca as ue,F as ce,G as P,H as D,Ja as T,Ka as fe,Ma as w,Na as N,Sa as O,Ta as G,Va as j,Wa as A,Xa as S,Ya as k,Za as z,a as R,b as st,l as Ze,n as U,p as _,s as y,t as ne,v as se,x as le,z as me}from"./chunk-D7MMK2W6.js";import{$ as tt,$a as B,$b as Qe,Ab as b,Cb as qe,Db as Be,Eb as Le,F as ee,Fb as a,Gb as o,H as te,Hb as d,Ib as c,Jb as u,L as ie,Lb as M,Ob as f,Qb as I,Ub as L,V as oe,Vb as Q,Wb as Z,Yc as nt,_a as s,_b as r,aa as ae,ac as g,ea as it,fa as C,gc as F,hc as W,ja as E,ka as re,ma as ot,mc as at,oc as rt,p as q,qb as m,sa as x,t as Y,ta as v,vb as p}from"./chunk-DAU7DYSH.js";var J=class t{constructor(e){this.http=e}apiUrl=S.apiUrlBase;getUsersPaginado(e,i,n){let l=new R({"Content-Type":"application/json"}),h={userName:n};return this.http.get(`${this.apiUrl}${S.EPGetUsersPaginado}/${e}/${i}`,{headers:l,params:h})}getUsers(){let e=new R({"Content-Type":"application/json"});return this.http.get(`${this.apiUrl}${S.EPGetUsers}`,{headers:e})}getUser(e){let i=new R({"Content-Type":"application/json"});return this.http.get(`${this.apiUrl}${S.EPGetUser}/${e}`,{headers:i})}createUser(e){let i=new R({"Content-Type":"application/json"});return this.http.post(`${this.apiUrl}${S.EPCreateUser}`,e,{headers:i})}updateUser(e){let i=new R({"Content-Type":"application/json"});return this.http.put(`${this.apiUrl}${S.EPUpdateUser}/${e.id}`,e,{headers:i})}deleteUser(e){let i=new R({"Content-Type":"application/json"});return this.http.delete(`${this.apiUrl}${S.EPDeleteUser}/${e}`,{headers:i})}getConductoresToHelp(){let e=new R({"Content-Type":"application/json"});return this.http.get(`${this.apiUrl}${S.EPListarConductoresToHelp}`,{headers:e})}static \u0275fac=function(i){return new(i||t)(it(st))};static \u0275prov=tt({token:t,factory:t.\u0275fac,providedIn:"root"})};var ze=class t{transform(e,i="Seleccione una opci\xF3n"){return e?[{id:0,nombre:i},...e]:[]}static \u0275fac=function(i){return new(i||t)};static \u0275pipe=ot({name:"prependZeroOption",type:t,pure:!0,standalone:!0})};var ft=()=>["DRIVE","WARE","ADMIN"];function gt(t,e){t&1&&(a(0,"mat-checkbox",4),r(1,"Cambiar Password"),o())}function ht(t,e){if(t&1&&(a(0,"mat-option",7),r(1),o()),t&2){let i=e.$implicit;p("value",i),s(),Qe(i)}}function Ct(t,e){if(t&1&&(a(0,"mat-option",7),r(1),o()),t&2){let i=e.$implicit;p("value",i.id),s(),Qe(i.nombre)}}function bt(t,e){t&1&&(a(0,"button",16)(1,"div",17),r(2," Grabando... "),o()())}function _t(t,e){if(t&1){let i=M();a(0,"button",14),f("click",function(){x(i);let l=I();return v(l.onSubmit())}),a(1,"mat-icon"),r(2,"save"),o(),r(3," Grabar "),o()}}var K=class t{constructor(e,i){this.fb=e;this.dialogRef=i;this.usuarioForm=this.fb.group({id:0,username:["",_.required],password:[""],role:["",_.required],conductorId:0,estado:["",_.required],cambiarPassword:!1})}data=C(we);adminModService=C(J);usuarioForm;loadingSave=!1;titulo=this.data.esNuevo?"Registrar Usuario":"Actualizar Usuario";usuarioSuscripcion;checkedPwd=!1;conductorErrorMessages={username:{required:"El nombre de usuario es obligatorio."},role:{required:"El rol es obligatorio."},estado:{required:"El estado es obligatorio."}};ngOnInit(){this.usuarioForm.reset(),this.data.esNuevo?this.usuarioForm.patchValue({estado:"A",conductorId:0}):(this.usuarioForm.patchValue(this.data.objUsuario),this.usuarioForm.get("password")?.setValue("*****"),this.usuarioForm.get("password")?.disable()),this.usuarioForm.get("cambiarPassword")?.valueChanges.subscribe(e=>{e?(this.usuarioForm.get("password")?.enable(),this.usuarioForm.get("password")?.setValidators([_.required,_.minLength(6)])):(this.usuarioForm.get("password")?.disable(),this.usuarioForm.get("password")?.clearValidators())})}ngOnDestroy(){this.usuarioSuscripcion&&this.usuarioSuscripcion.unsubscribe()}onSubmit(){if(this.data.esNuevo&&this.usuarioForm.invalid)return;if(!this.data.esNuevo&&this.usuarioForm.get("cambiarPassword")?.value&&!this.usuarioForm.get("password")?.value){console.log("Debe ingresar una contrase\xF1a");return}let e=this.usuarioForm.value,i=e,n={id:e.id,username:e.username,password:e.cambiarPassword?e.password:"",role:e.role,conductorId:e.conductorId,estado:e.estado};console.log("usuarioDataCreate: ==>",i),console.log("usuarioDataUpdate: ==>",n),this.loadingSave=!0;let l=this.data.esNuevo?this.adminModService.createUser(i):this.adminModService.updateUser(n);this.usuarioSuscripcion=l.subscribe({next:h=>{this.loadingSave=!1,this.dialogRef.close(h)},error:h=>{console.log(h),this.loadingSave=!1}})}onCancel(){this.dialogRef.close()}static \u0275fac=function(i){return new(i||t)(B(ce),B(Te))};static \u0275cmp=E({type:t,selectors:[["app-dialog-form-reg-usuario"]],standalone:!0,features:[F],decls:44,vars:11,consts:[["mat-dialog-title",""],[2,"padding","5px","display","flex","flex-direction","column",3,"formGroup"],["appearance","outline"],["matInput","","formControlName","username"],["formControlName","cambiarPassword"],["matInput","","formControlName","password","type","password"],["formControlName","role"],[3,"value"],["formControlName","conductorId"],["formControlName","estado"],["value","A"],["value","I"],[3,"form","errorMessages"],[2,"display","flex","justify-content","space-evenly"],["mat-fab","","extended","",3,"click"],[2,"color","red"],["mat-fab","","extended",""],[2,"display","flex","gap","5px"]],template:function(i,n){i&1&&(a(0,"h2",0)(1,"mat-icon"),r(2,"edit_note"),o(),r(3),o(),a(4,"mat-dialog-content")(5,"form",1)(6,"mat-form-field",2)(7,"mat-label"),r(8,"Nombre de Usuario"),o(),d(9,"input",3),o(),m(10,gt,2,0,"mat-checkbox",4),a(11,"mat-form-field",2)(12,"mat-label"),r(13,"Clave"),o(),d(14,"input",5),o(),a(15,"mat-form-field",2)(16,"mat-label"),r(17,"Rol"),o(),a(18,"mat-select",6),Be(19,ht,2,2,"mat-option",7,qe),o()(),a(21,"mat-form-field",2)(22,"mat-label"),r(23,"Conductor"),o(),a(24,"mat-select",8),Be(25,Ct,2,2,"mat-option",7,qe),at(27,"prependZeroOption"),o()(),a(28,"mat-form-field",2)(29,"mat-label"),r(30,"Estado"),o(),a(31,"mat-select",9)(32,"mat-option",10),r(33," Activo "),o(),a(34,"mat-option",11),r(35," Inactivo "),o()()(),d(36,"app-form-errors",12),o()(),a(37,"mat-dialog-actions",13)(38,"button",14),f("click",function(){return n.onCancel()}),a(39,"mat-icon",15),r(40,"cancel"),o(),r(41," Cancelar "),o(),m(42,bt,3,0,"button",16)(43,_t,4,0,"button",16),o()),i&2&&(s(3),g(" ",n.titulo,`
`),s(2),p("formGroup",n.usuarioForm),s(5),b(n.data.esNuevo?-1:10),s(9),Le(W(10,ft)),s(6),Le(rt(27,7,n.data.objConductores,"[Seleccione uno]")),s(11),p("form",n.usuarioForm)("errorMessages",n.conductorErrorMessages),s(6),b(n.loadingSave?42:-1),s(),b(n.loadingSave?-1:43))},dependencies:[P,le,U,y,ne,D,pe,de,G,O,N,A,j,je,Oe,Ge,z,k,mt,lt,Ue,Re,ue,w,T,ze,ke]})};var vt=()=>[5,10,20];function Mt(t,e){t&1&&(a(0,"th",22),r(1," Editar "),o())}function It(t,e){if(t&1){let i=M();a(0,"td",23)(1,"button",24),f("click",function(){let l=x(i).$implicit,h=I();return v(h.editarUsuario(l))}),a(2,"mat-icon"),r(3,"edit"),o()()()}}function Ft(t,e){t&1&&(a(0,"th",25),r(1," Nombre de Usuario "),o())}function Rt(t,e){if(t&1&&(a(0,"td",23),r(1),o()),t&2){let i=e.$implicit;s(),g(" ",i.username," ")}}function Ut(t,e){t&1&&(a(0,"th",25),r(1," Role "),o())}function yt(t,e){if(t&1&&(a(0,"td",23),r(1),o()),t&2){let i=e.$implicit;s(),g(" ",i.role," ")}}function Pt(t,e){t&1&&(a(0,"th",25),r(1," Conductor "),o())}function Dt(t,e){if(t&1&&(a(0,"td",23),r(1),o()),t&2){let i=e.$implicit;s(),g(" ",i.conductor," ")}}function Tt(t,e){t&1&&(a(0,"th",22),r(1," Estado "),o())}function wt(t,e){t&1&&(a(0,"span",27),r(1,"Activo"),o())}function Nt(t,e){t&1&&(a(0,"span",28),r(1,"Inactivo"),o())}function Ot(t,e){t&1&&(a(0,"span",28),r(1,"I"),o())}function Gt(t,e){if(t&1&&(a(0,"td",26),m(1,wt,2,0,"span",27)(2,Nt,2,0,"span",28)(3,Ot,2,0,"span",28),o()),t&2){let i,n=e.$implicit;s(),b((i=n.estado)==="A"?1:i==="I"?2:3)}}function jt(t,e){t&1&&d(0,"tr",29)}function At(t,e){t&1&&d(0,"tr",30)}var Ve=class t{adminMofService=C(J);dialog=C(Ne);displayedColumns=["username","role","conductor","estado","actions"];dataSource=new Fe([]);totalProducts=0;pageSize=10;bolFiltro=!1;filterControl=new se;conductoresSubscription;conductores=[];paginator;sort;ngOnInit(){this.cargarUsuarios(1,10,""),this.cargarConducores(),this.filterControl.valueChanges.pipe(te(300),ie(),oe(e=>e===""?q([]):this.adminMofService.getUsersPaginado(1,10,e).pipe(Y(i=>(this.totalProducts=i.totalCount,i.data??[])),ee(i=>(console.error("Error al aplicar el filtro:",i),this.totalProducts=0,this.paginator.length=0,q([])))))).subscribe({next:e=>{if(this.filterControl.value===""){this.limpiaFiltro();return}this.bolFiltro=!0,this.dataSource.data=e,this.paginator.length=this.totalProducts,this.paginator.pageIndex=0},error:e=>{console.error("Error al aplicar el filtro:",e),this.bolFiltro=!0,this.dataSource.data=[],this.totalProducts=0,this.paginator.length=0}})}ngOnDestroy(){this.conductoresSubscription?.unsubscribe()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.paginator.page.subscribe(()=>{this.bolFiltro?this.cargarUsuarios(this.paginator.pageIndex+1,this.paginator.pageSize,this.filterControl.value):this.cargarUsuarios(this.paginator.pageIndex+1,this.paginator.pageSize,"")})}limpiaFiltro(){this.bolFiltro=!1,this.cargarUsuarios(1,10,""),this.filterControl.setValue("")}applyFilter(e){let i=e.target.value;this.dataSource.filter=i.trim().toLowerCase()}cargarUsuarios(e,i,n){this.conductoresSubscription=this.adminMofService.getUsersPaginado(e,i,n).subscribe({next:l=>{this.dataSource.data=l.data??[],this.totalProducts=l.totalCount,this.paginator.length=this.totalProducts},error:l=>{console.error("Error al cargar los veh\xEDculos:",l),this.dataSource.data=[],this.totalProducts=0,this.paginator.length=0}})}cargarConducores(){this.conductoresSubscription=this.adminMofService.getConductoresToHelp().subscribe({next:e=>{this.conductores=e.data??[]},error:e=>{console.error("Error al cargar los conductores:",e)}})}editarUsuario(e){this.dialog.open(K,{data:{esNuevo:!1,objUsuario:e,objConductores:this.conductores},width:"400px"}).afterClosed().subscribe(n=>{n&&this.cargarUsuarios(this.paginator.pageIndex+1,this.paginator.pageSize,"")})}nuevoUsuario(){this.dialog.open(K,{data:{esNuevo:!0,objUsuario:null,objConductores:this.conductores},width:"400px"}).afterClosed().subscribe(i=>{i&&this.cargarUsuarios(this.paginator.pageIndex+1,this.paginator.pageSize,"")})}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=E({type:t,selectors:[["app-page-usuarios"]],viewQuery:function(i,n){if(i&1&&(L(V,7),L(H,5)),i&2){let l;Q(l=Z())&&(n.paginator=l.first),Q(l=Z())&&(n.sort=l.first)}},standalone:!0,features:[F],decls:41,vars:9,consts:[[1,"container-mntUser"],[2,"display","flex","justify-content","space-between","border","1px solid gainsboro","border-radius","5px","padding","5px","margin-bottom","5px"],[2,"display","flex","gap","5px","align-items","center"],[1,"section-controls"],[2,"display","flex","gap","5px"],["appearance","outline",2,"width","100%"],["matInput","","placeholder","ingrese nombre del Usuario",3,"formControl"],["mat-fab","",3,"click","disabled"],["mat-fab","","extended","",3,"click"],[3,"length","pageSize","pageSizeOptions"],["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","username"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","role"],["matColumnDef","conductor"],["matColumnDef","estado"],["mat-cell","","style","text-align: center;",4,"matCellDef"],["mat-header-row","","class","cabecera",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-mini-fab","",3,"click"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",2,"text-align","center"],[2,"color","green"],[2,"color","red"],["mat-header-row","",1,"cabecera"],["mat-row",""]],template:function(i,n){i&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-icon"),r(4,"account_box"),o(),a(5,"label")(6,"strong"),r(7,"Registro de Usuarios"),o()()()(),a(8,"div",3)(9,"div",4)(10,"mat-form-field",5)(11,"mat-label"),r(12,"Buscar Usuario"),o(),d(13,"input",6),o(),a(14,"button",7),f("click",function(){return n.limpiaFiltro()}),a(15,"mat-icon"),r(16,"filter_alt_off"),o()()(),a(17,"button",8),f("click",function(){return n.nuevoUsuario()}),a(18,"mat-icon"),r(19,"library_add"),o(),r(20," Nuevo Usuario "),o(),a(21,"div"),d(22,"mat-paginator",9),o()(),a(23,"table",10),c(24,11),m(25,Mt,2,0,"th",12)(26,It,4,0,"td",13),u(),c(27,14),m(28,Ft,2,0,"th",15)(29,Rt,2,1,"td",13),u(),c(30,16),m(31,Ut,2,0,"th",15)(32,yt,2,1,"td",13),u(),c(33,17),m(34,Pt,2,0,"th",15)(35,Dt,2,1,"td",13),u(),c(36,18),m(37,Tt,2,0,"th",12)(38,Gt,4,1,"td",19),u(),m(39,jt,1,0,"tr",20)(40,At,1,0,"tr",21),o()()),i&2&&(s(13),p("formControl",n.filterControl),s(),p("disabled",!n.bolFiltro),s(8),p("length",n.totalProducts)("pageSize",n.pageSize)("pageSizeOptions",W(8,vt)),s(),p("dataSource",n.dataSource),s(16),p("matHeaderRowDef",n.displayedColumns),s(),p("matRowDefColumns",n.displayedColumns))},dependencies:[z,k,Ie,ge,Ce,Ee,be,he,xe,_e,Se,ve,Me,A,j,O,N,G,ye,V,De,H,Pe,w,fe,T,P,U,y,D,me],styles:[".container-mntUser[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;margin:10px}.section-controls[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:space-between;border:1px solid #ccc;border-radius:5px;padding:5px}.cabecera[_ngcontent-%COMP%]{text-align:center;padding:0!important;background-color:#7d9ad6;color:#fff;border:1px solid #ccc!important;border-radius:5px}@media (max-width: 768px){.container-mntUser[_ngcontent-%COMP%]{margin:5px;gap:5px}.section-controls[_ngcontent-%COMP%]{flex-direction:column;gap:10px;padding:3px}.cabecera[_ngcontent-%COMP%]{font-size:1rem;padding:4px 0!important}}@media (max-width: 600px){.container-mntUser[_ngcontent-%COMP%]{margin:5px;gap:5px}.section-controls[_ngcontent-%COMP%]{flex-direction:column;gap:20px;padding:3px}.cabecera[_ngcontent-%COMP%]{font-size:1rem;padding:4px 0!important}[_nghost-%COMP%]     .mat-mdc-paginator-page-size-label{display:none!important}}"]})};function kt(t,e){t&1&&(a(0,"button",15)(1,"div",16),r(2," Grabando... "),o()())}function zt(t,e){if(t&1){let i=M();a(0,"button",13),f("click",function(){x(i);let l=I();return v(l.onSubmit())}),a(1,"mat-icon"),r(2,"save"),o(),r(3," Grabar "),o()}}var X=class t{constructor(e,i){this.fb=e;this.dialogRef=i;this.empresaForm=this.fb.group({id:0,ruc:["",_.required],razonSocial:["",_.required],direccion:[""],telefono:[""],email:["",[_.email]],estadoRegistro:["",_.required]})}data=C(we);adminOfService=C(Ae);empresaForm;loadingSave=!1;titulo=this.data.esNuevo?"Registrar Empresa":"Actualizar Empresa";empresaSuscripcion;empresaErrorMessages={ruc:{required:"El RUC es obligatorio."},razonSocial:{required:"La raz\xF3n social es obligatoria."},direccion:{required:"La direcci\xF3n es obligatoria."},telefono:{required:"El tel\xE9fono es obligatorio."},email:{required:"El email es obligatorio."},estado:{required:"El estado es obligatorio."}};ngOnInit(){this.empresaForm.reset(),this.data.esNuevo?this.empresaForm.patchValue({estado:"A"}):this.empresaForm.patchValue(this.data.objEmpresa)}ngOnDestroy(){this.empresaSuscripcion&&this.empresaSuscripcion.unsubscribe()}onSubmit(){if(this.empresaForm.invalid)return;let e=this.empresaForm.value,i=e,n=e;this.loadingSave=!0;let l=this.data.esNuevo?this.adminOfService.createEmpresaTransporte(i):this.adminOfService.updateEmpresaTransporte(n);this.empresaSuscripcion=l.subscribe({next:h=>{this.loadingSave=!1,this.dialogRef.close(h)},error:h=>{console.log(h),this.loadingSave=!1}})}onCancel(){this.dialogRef.close()}static \u0275fac=function(i){return new(i||t)(B(ce),B(Te))};static \u0275cmp=E({type:t,selectors:[["app-dialog-form-empresa"]],standalone:!0,features:[F],decls:42,vars:6,consts:[["mat-dialog-title",""],[2,"padding","5px","display","flex","flex-direction","column",3,"formGroup"],["appearance","outline"],["matInput","","formControlName","ruc"],["matInput","","formControlName","razonSocial"],["matInput","","formControlName","direccion"],["matInput","","formControlName","telefono"],["matInput","","formControlName","email","type","email"],["formControlName","estadoRegistro"],["value","A"],["value","I"],[3,"form","errorMessages"],[2,"display","flex","justify-content","space-evenly"],["mat-fab","","extended","",3,"click"],[2,"color","red"],["mat-fab","","extended",""],[2,"display","flex","gap","5px"]],template:function(i,n){i&1&&(a(0,"h2",0)(1,"mat-icon"),r(2,"edit_note"),o(),r(3),o(),a(4,"mat-dialog-content")(5,"form",1)(6,"mat-form-field",2)(7,"mat-label"),r(8,"RUC"),o(),d(9,"input",3),o(),a(10,"mat-form-field",2)(11,"mat-label"),r(12,"Raz\xF3n Social"),o(),d(13,"input",4),o(),a(14,"mat-form-field",2)(15,"mat-label"),r(16,"Direccion"),o(),d(17,"input",5),o(),a(18,"mat-form-field",2)(19,"mat-label"),r(20,"Telefono"),o(),d(21,"input",6),o(),a(22,"mat-form-field",2)(23,"mat-label"),r(24,"Email"),o(),d(25,"input",7),o(),a(26,"mat-form-field",2)(27,"mat-label"),r(28,"Estado"),o(),a(29,"mat-select",8)(30,"mat-option",9),r(31," Activo "),o(),a(32,"mat-option",10),r(33," Inactivo "),o()()(),d(34,"app-form-errors",11),o()(),a(35,"mat-dialog-actions",12)(36,"button",13),f("click",function(){return n.onCancel()}),a(37,"mat-icon",14),r(38,"cancel"),o(),r(39," Cancelar "),o(),m(40,kt,3,0,"button",15)(41,zt,4,0,"button",15),o()),i&2&&(s(3),g(" ",n.titulo,`
`),s(2),p("formGroup",n.empresaForm),s(29),p("form",n.empresaForm)("errorMessages",n.empresaErrorMessages),s(6),b(n.loadingSave?40:-1),s(),b(n.loadingSave?-1:41))},dependencies:[P,le,U,y,ne,D,pe,de,G,O,N,A,j,je,Oe,Ge,z,k,ke,w,T,Ue,Re,ue]})};var Vt=()=>[5,10,20];function Ht(t,e){t&1&&(a(0,"th",24),r(1," Editar "),o())}function $t(t,e){if(t&1){let i=M();a(0,"td",25)(1,"button",26),f("click",function(){let l=x(i).$implicit,h=I();return v(h.editarEmpresa(l))}),a(2,"mat-icon"),r(3,"edit"),o()()()}}function qt(t,e){t&1&&(a(0,"th",27),r(1," RUC "),o())}function Bt(t,e){if(t&1&&(a(0,"td",25),r(1),o()),t&2){let i=e.$implicit;s(),g(" ",i.ruc," ")}}function Lt(t,e){t&1&&(a(0,"th",27),r(1," Razon Social "),o())}function Qt(t,e){if(t&1&&(a(0,"td",25),r(1),o()),t&2){let i=e.$implicit;s(),g(" ",i.razonSocial," ")}}function Zt(t,e){t&1&&(a(0,"th",27),r(1," Direcci\xF3n "),o())}function Wt(t,e){if(t&1&&(a(0,"td",25),r(1),o()),t&2){let i=e.$implicit;s(),g(" ",i.direccion," ")}}function Jt(t,e){t&1&&(a(0,"th",27),r(1," Tel\xE9fono "),o())}function Kt(t,e){if(t&1&&(a(0,"td",25),r(1),o()),t&2){let i=e.$implicit;s(),g(" ",i.telefono," ")}}function Xt(t,e){t&1&&(a(0,"th",27),r(1," Email "),o())}function Yt(t,e){if(t&1&&(a(0,"td",25),r(1),o()),t&2){let i=e.$implicit;s(),g(" ",i.email," ")}}function ei(t,e){t&1&&(a(0,"th",24),r(1," Estado "),o())}function ti(t,e){t&1&&(a(0,"span",29),r(1,"Activo"),o())}function ii(t,e){t&1&&(a(0,"span",30),r(1,"Inactivo"),o())}function oi(t,e){t&1&&(a(0,"span",30),r(1,"I"),o())}function ai(t,e){if(t&1&&(a(0,"td",28),m(1,ti,2,0,"span",29)(2,ii,2,0,"span",30)(3,oi,2,0,"span",30),o()),t&2){let i,n=e.$implicit;s(),b((i=n.estadoRegistro)==="A"?1:i==="I"?2:3)}}function ri(t,e){t&1&&d(0,"tr",31)}function ni(t,e){t&1&&d(0,"tr",32)}var He=class t{adminMofService=C(Ae);dialog=C(Ne);displayedColumns=["ruc","razonSocial","direccion","telefono","email","estado","actions"];dataSource=new Fe([]);totalProducts=0;pageSize=10;bolFiltro=!1;filterControl=new se;empresasSubscription;empresas=[];paginator;sort;ngOnInit(){this.cargarEmpresas(1,10,""),this.filterControl.valueChanges.pipe(te(300),ie(),oe(e=>e===""?q([]):this.adminMofService.getEmpresasTransportePaginado(1,10,e).pipe(Y(i=>(this.totalProducts=i.totalCount,i.data??[])),ee(i=>(console.error("Error al aplicar el filtro:",i),this.totalProducts=0,this.paginator.length=0,q([])))))).subscribe({next:e=>{if(this.filterControl.value===""){this.limpiaFiltro();return}this.bolFiltro=!0,this.dataSource.data=e,this.paginator.length=this.totalProducts,this.paginator.pageIndex=0},error:e=>{console.error("Error al aplicar el filtro:",e),this.bolFiltro=!0,this.dataSource.data=[],this.totalProducts=0,this.paginator.length=0}})}ngOnDestroy(){this.empresasSubscription?.unsubscribe()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.paginator.page.subscribe(()=>{this.bolFiltro?this.cargarEmpresas(this.paginator.pageIndex+1,this.paginator.pageSize,this.filterControl.value):this.cargarEmpresas(this.paginator.pageIndex+1,this.paginator.pageSize,"")})}limpiaFiltro(){this.bolFiltro=!1,this.cargarEmpresas(1,10,""),this.filterControl.setValue("")}applyFilter(e){let i=e.target.value;this.dataSource.filter=i.trim().toLowerCase()}cargarEmpresas(e,i,n){this.empresasSubscription=this.adminMofService.getEmpresasTransportePaginado(e,i,n).subscribe({next:l=>{this.dataSource.data=l.data??[],this.totalProducts=l.totalCount,this.paginator.length=this.totalProducts},error:l=>{console.error("Error al cargar los veh\xEDculos:",l),this.dataSource.data=[],this.totalProducts=0,this.paginator.length=0}})}editarEmpresa(e){this.dialog.open(X,{data:{esNuevo:!1,objEmpresa:e},width:"400px"}).afterClosed().subscribe(n=>{n&&this.cargarEmpresas(this.paginator.pageIndex+1,this.paginator.pageSize,"")})}nuevoEmpresa(){this.dialog.open(X,{data:{esNuevo:!0,objEmpresa:null},width:"400px"}).afterClosed().subscribe(i=>{i&&this.cargarEmpresas(this.paginator.pageIndex+1,this.paginator.pageSize,"")})}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=E({type:t,selectors:[["app-page-empresa"]],viewQuery:function(i,n){if(i&1&&(L(V,7),L(H,5)),i&2){let l;Q(l=Z())&&(n.paginator=l.first),Q(l=Z())&&(n.sort=l.first)}},standalone:!0,features:[F],decls:46,vars:9,consts:[[1,"container-mntUser"],[2,"display","flex","justify-content","space-between","border","1px solid gainsboro","border-radius","5px","padding","5px","margin-bottom","5px"],[2,"display","flex","gap","5px","align-items","center"],[1,"section-controls"],[2,"display","flex","gap","5px"],["appearance","outline"],["matInput","","placeholder","ingrese nombre del Usuario",3,"formControl"],["mat-fab","",3,"click","disabled"],["mat-fab","","extended","",3,"click"],[3,"length","pageSize","pageSizeOptions"],["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","ruc"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","razonSocial"],["matColumnDef","direccion"],["matColumnDef","telefono"],["matColumnDef","email"],["matColumnDef","estado"],["mat-cell","","style","text-align: center;",4,"matCellDef"],["mat-header-row","","class","cabecera",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-mini-fab","",3,"click"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",2,"text-align","center"],[2,"color","green"],[2,"color","red"],["mat-header-row","",1,"cabecera"],["mat-row",""]],template:function(i,n){i&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-icon"),r(4,"account_box"),o(),a(5,"label")(6,"strong"),r(7,"Registro de Empresas"),o()()()(),a(8,"div",3)(9,"div",4)(10,"mat-form-field",5)(11,"mat-label"),r(12,"Buscar Empresa"),o(),d(13,"input",6),o(),a(14,"button",7),f("click",function(){return n.limpiaFiltro()}),a(15,"mat-icon"),r(16,"filter_alt_off"),o()()(),a(17,"button",8),f("click",function(){return n.nuevoEmpresa()}),a(18,"mat-icon"),r(19,"library_add"),o(),r(20," Nueva Empresa "),o(),d(21,"mat-paginator",9),o(),a(22,"table",10),c(23,11),m(24,Ht,2,0,"th",12)(25,$t,4,0,"td",13),u(),c(26,14),m(27,qt,2,0,"th",15)(28,Bt,2,1,"td",13),u(),c(29,16),m(30,Lt,2,0,"th",15)(31,Qt,2,1,"td",13),u(),c(32,17),m(33,Zt,2,0,"th",15)(34,Wt,2,1,"td",13),u(),c(35,18),m(36,Jt,2,0,"th",15)(37,Kt,2,1,"td",13),u(),c(38,19),m(39,Xt,2,0,"th",15)(40,Yt,2,1,"td",13),u(),c(41,20),m(42,ei,2,0,"th",12)(43,ai,4,1,"td",21),u(),m(44,ri,1,0,"tr",22)(45,ni,1,0,"tr",23),o()()),i&2&&(s(13),p("formControl",n.filterControl),s(),p("disabled",!n.bolFiltro),s(7),p("length",n.totalProducts)("pageSize",n.pageSize)("pageSizeOptions",W(8,Vt)),s(),p("dataSource",n.dataSource),s(22),p("matHeaderRowDef",n.displayedColumns),s(),p("matRowDefColumns",n.displayedColumns))},dependencies:[z,k,A,j,O,N,G,Ie,ge,Ce,Ee,be,he,xe,_e,Se,ve,Me,ye,V,De,H,Pe,w,fe,T,P,U,y,D,me],styles:[".container-mntUser[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;margin:10px}.section-controls[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:space-between;border:1px solid #ccc;border-radius:5px;padding:5px}.cabecera[_ngcontent-%COMP%]{text-align:center;padding:0!important;background-color:#7d9ad6;color:#fff;border:1px solid #ccc!important;border-radius:5px}"]})};var si=[{path:"",redirectTo:"usuarios",pathMatch:"full"},{path:"usuarios",component:Ve,title:"Usuarios - Administracion"},{path:"empresas",component:He,title:"Empresas - Administracion"}],$e=class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=re({type:t});static \u0275inj=ae({imports:[Ze.forChild(si),Ze]})};var pt=class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=re({type:t});static \u0275inj=ae({imports:[nt,$e]})};export{pt as AdministracionModule};
